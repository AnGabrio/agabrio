---
title: "Super basic introduction to missingHE"
author: "Andrea Gabrio"
date: 2018-08-27T21:13:14-05:00
categories: ["R"]
tags: ["linear regression", "JAGS", "introduction"]
authors: ["Andrea Gabrio"]
bibliography: [citations_jags.bib]
draft: no
slug: super-basic-introduction-to-missinghe
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, prompt = TRUE, background = '#FFFFFF')
```

The focus of this simple tutorial is to provide a brief introduction and overview about how to fit Bayesian models using `JAGS` via `R`.

Prerequisites:

* The latest version of `R`, which can be downloaded and installed for Windows, Mac or Linux OS from the [CRAN](https://www.r-project.org/}) website
* I also **strongly** recommend to download and install [Rstudio](https://www.rstudio.com/), an integrated development environment which provides an "user-friendly" interaction with `R` (e.g. many drop-down menus, tabs, customisation options)

# Preliminaries

## What is JAGS?

`JAGS` or **J**ust **A**nother **G**ibbs **S**ampler is a program for analysis of Bayesian models using Markov Chain Monte Carlo (MCMC) methods (@plummer2004jags). `JAGS` is a free software based on the **B**ayesian inference **U**sing **G**ibbs **S**ampling (informally `BUGS`) language at the base of `WinBUGS/OpenBUGS` but, unlike these programs, it is written in `C++` and is platform independent. The latest version of `JAGS` can be dowloaded from Martyn Plummer's [repository](https://sourceforge.net/projects/mcmc-jags/files/JAGS/) and is available for different OS. There are different `R` packages which function as frontends for `JAGS`. These packages make it easy to process the output of Bayesian models and present it in publication-ready form. In this brief introduction, I will specifically focus on the `R2jags` package (@su2015package) and show how to fit `JAGS` models using this package.

## Installing JAGS and R2jags

Install the latest version of `JAGS` for your OS. Next, install the package `R2jags` from within `R` or `Rstudio`, via the package installer or by typing in the command line

```{r install_jags, eval=FALSE, echo=TRUE}
install.packages("R2jags", dependencies = TRUE)
```

The `dependencies = TRUE` option will automatically install all the packages on which the functions in the `R2jags` package rely.

# Basic model

## Simulate data

For an example dataset, I simulate my own data in `R`. I create a continuous outcome variable $y$ as a function of one predictor $x$ and a disturbance term $\epsilon$. I simulate a dataset with 100 observations. Create the error term, the predictor and the outcome using a linear form with an intercept $\beta_0$ and slope $\beta_1$ coefficients, i.e.

\[y = \beta_0 + \beta_1 x + \epsilon  \]

The `R` commands which I use to simulate the data are the following:

```{r basic_model, eval=TRUE, echo=TRUE}
n.sim=100; set.seed(123)
x=rnorm(n.sim, mean = 5, sd = 2)
epsilon=rnorm(n.sim, mean = 0, sd = 1)
beta0=1.5
beta1=1.2
y=beta0 + beta1 * x + epsilon
```

Then, I define all the data for `JAGS` in a list object

```{r data_list, eval=TRUE, echo=TRUE}
datalist=list("y","x","n.sim")
```

## Model file

Now, I write the model for `JAGS` and save it as a text file named `"basic.mod.txt"` in the current working directory

```{r txt_model, eval=TRUE, echo=TRUE}
basic.mod= "
model {
#model
 for(i in 1:n.sim){
  y[i] ~ dnorm(mu[i], tau)
  mu[i] = beta0 + beta1 * x[i]
 }
#priors
beta0 ~ dnorm(0, 0.01)
beta1 ~ dnorm(0, 0.01)
tau ~ dgamma(0.01,0.01)
}
"
```

# References

